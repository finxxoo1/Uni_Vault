# ðŸ—ï¸ UniVault Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User Interface                        â”‚
â”‚                    (Mobile-First Web App)                    â”‚
â”‚                      http://localhost:3000                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Express API Server                      â”‚
â”‚                         (Node.js)                            â”‚
â”‚                                                              â”‚
â”‚  Endpoints:                                                  â”‚
â”‚  â€¢ GET  /api/info                                           â”‚
â”‚  â€¢ GET  /api/vault/:address/balance                         â”‚
â”‚  â€¢ POST /api/vault/create                                   â”‚
â”‚  â€¢ GET  /api/ticket/verify/:address/:assetId                â”‚
â”‚  â€¢ GET  /api/account/:address                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Algorand SDK Layer                        â”‚
â”‚                   (@algorand/algosdk)                        â”‚
â”‚                                                              â”‚
â”‚  Functions:                                                  â”‚
â”‚  â€¢ Account generation                                        â”‚
â”‚  â€¢ Transaction signing                                       â”‚
â”‚  â€¢ TEAL compilation                                          â”‚
â”‚  â€¢ Asset creation (NFTs)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Algorand Testnet                           â”‚
â”‚                (Blockchain Layer 1)                          â”‚
â”‚                                                              â”‚
â”‚  Components:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Smart Contracts  â”‚  â”‚   NFT Assets     â”‚                â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚                â”‚
â”‚  â”‚ â€¢ LogicSig       â”‚  â”‚ â€¢ Event Tickets  â”‚                â”‚
â”‚  â”‚ â€¢ Multi-Sig      â”‚  â”‚ â€¢ Asset ID       â”‚                â”‚
â”‚  â”‚ â€¢ Conditional    â”‚  â”‚ â€¢ Metadata       â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Details

### 1. Frontend Layer (public/index.html)
**Technology:** Vanilla HTML/CSS/JavaScript
**Purpose:** User interaction interface

**Features:**
- ðŸ“± Mobile-first responsive design
- ðŸŽ¨ Three-tab navigation (Dashboard, Create Vault, Tickets)
- âš¡ Real-time blockchain data display
- ðŸ”„ AJAX calls to backend API

**Key UI Components:**
```
Dashboard Tab
â”œâ”€â”€ Deployment Status Card
â”œâ”€â”€ Active Vaults Card
â”‚   â”œâ”€â”€ Conditional Vault
â”‚   â””â”€â”€ Multi-Sig Vault
â””â”€â”€ NFT Tickets Card

Create Vault Tab
â”œâ”€â”€ Vault Creation Form
â”œâ”€â”€ Goal & Deadline Inputs
â””â”€â”€ Success/Error Messages

Tickets Tab
â”œâ”€â”€ Verification Form
â””â”€â”€ QR Scanner Placeholder
```

---

### 2. Backend Layer (server.js)
**Technology:** Express.js + Node.js
**Purpose:** API gateway to Algorand blockchain

**Responsibilities:**
- ðŸ”Œ Route HTTP requests
- ðŸ” Manage Algorand client connections
- ðŸ“Š Format blockchain data for frontend
- ðŸ›¡ï¸ Error handling and validation

**API Routes:**
```javascript
GET  /api/info                              // Get deployment info
GET  /api/vault/:address/balance            // Check vault balance
POST /api/vault/create                      // Create new vault
GET  /api/ticket/verify/:address/:assetId   // Verify ticket ownership
GET  /api/account/:address                  // Get account details
GET  /api/health                            // Health check
```

---

### 3. Smart Contract Layer (contracts/VaultContract.js)
**Technology:** Algorand TEAL via JS SDK
**Purpose:** Business logic enforcement on blockchain

#### 3.1 Conditional Vault (LogicSig)
**TEAL Logic:**
```teal
#pragma version 8

// Check transaction type is payment
txn TypeEnum
int pay
==

// Check amount meets or exceeds goal
txn Amount
int GOAL_AMOUNT
>=
&&

// Check deadline hasn't passed
txn FirstValid
int DEADLINE
<=
&&

// Check receiver is authorized
txn Receiver
addr CREATOR_ADDRESS
==
&&
```

**Enforces:**
- âœ… Funds only released if goal met
- âœ… Deadline validation
- âœ… Authorized receiver check

#### 3.2 Multi-Signature Vault
**Configuration:**
```javascript
{
  version: 1,
  threshold: 2,        // 2 of 3 required
  addrs: [addr1, addr2, addr3]
}
```

**Enforces:**
- âœ… Requires 2 signatures from 3 authorized accounts
- âœ… Prevents single point of failure
- âœ… Democratic fund management

#### 3.3 NFT Ticketing System
**Asset Creation:**
```javascript
{
  total: 100,           // Total ticket supply
  decimals: 0,          // Indivisible tickets
  assetName: "Event",   // Event name
  unitName: "TICKET",   // Ticker
  freeze: true,         // Prevent transfers
  clawback: true        // Revoke if needed
}
```

**Features:**
- ðŸŽŸï¸ Unique asset ID per event
- ðŸ”’ Non-fungible (decimals: 0)
- âœ… Verifiable ownership
- ðŸš« Fraud prevention

---

## Data Flow Examples

### Example 1: Creating a Vault
```
User (Browser)
   â”‚
   â”‚ 1. Fill form (name, goal, deadline)
   â–¼
Frontend (index.html)
   â”‚
   â”‚ 2. POST /api/vault/create
   â–¼
Backend (server.js)
   â”‚
   â”‚ 3. Call VaultContract.createVault()
   â–¼
Algorand SDK
   â”‚
   â”‚ 4. Compile TEAL program
   â”‚ 5. Generate vault address
   â–¼
Algorand Testnet
   â”‚
   â”‚ 6. Contract deployed
   â—„â”€â”€â”€â”€â”€â”
   â”‚     â”‚ 7. Return vault address
   â–¼     â”‚
User sees vault created âœ…
```

### Example 2: Verifying a Ticket
```
User (Browser)
   â”‚
   â”‚ 1. Enter address + Asset ID
   â–¼
Frontend
   â”‚
   â”‚ 2. GET /api/ticket/verify/:address/:assetId
   â–¼
Backend
   â”‚
   â”‚ 3. Call algodClient.accountInformation()
   â–¼
Algorand Testnet
   â”‚
   â”‚ 4. Query account assets
   â—„â”€â”€â”€â”€â”€â”
   â”‚     â”‚ 5. Return asset holdings
   â–¼     â”‚
User sees verification âœ…/âŒ
```

### Example 3: Funding a Vault
```
Contributor 1
   â”‚
   â”‚ 1. Send ALGO to vault address
   â–¼
Algorand Testnet
   â”‚
   â”‚ 2. Transaction recorded on blockchain
   â”‚ 3. Vault balance updates
   â–¼
Smart Contract
   â”‚
   â”‚ 4. Check if goal met
   â”‚ 5. If yes: enable fund release
   â”‚ 6. If no: keep locked
   â–¼
Dashboard
   â”‚
   â”‚ 7. Balance updates in real-time
   â–¼
All users see updated balance ðŸ“Š
```

---

## Security Model

### 1. Key Management
```
Creator Account (Testnet)
â”œâ”€â”€ Private Key: Stored locally (deployment-info.json)
â”œâ”€â”€ Public Address: Shared with vault
â””â”€â”€ Mnemonic: For account recovery

âš ï¸ PRODUCTION: Use hardware wallets or MPC
```

### 2. Contract Immutability
```
Once deployed:
â”œâ”€â”€ TEAL code cannot change
â”œâ”€â”€ Rules are permanent
â””â”€â”€ No admin backdoors

This ensures:
âœ… Trustless operation
âœ… Transparent enforcement
âœ… No human intervention needed
```

### 3. Multi-Signature Protection
```
Large Fund Vaults:
â”œâ”€â”€ Require M of N signatures
â”œâ”€â”€ Example: 2 of 3 club officers
â””â”€â”€ Prevents single-person control

Benefits:
âœ… Democratic decision-making
âœ… Fraud prevention
âœ… Dispute resolution
```

---

## Algorand Network Configuration

### Testnet Connection
```javascript
const algodClient = new algosdk.Algodv2(
  'aaaa...aaaa',                       // Token (public testnet)
  'https://testnet-api.algonode.cloud', // Server
  443                                   // Port
);
```

### Transaction Costs
```
Base Transaction Fee: 0.001 ALGO (~$0.0003 USD)
Asset Creation: 0.1 ALGO (one-time)
Asset Transfer: 0.001 ALGO

VS. Competitors:
â€¢ Ethereum: $1-50 per transaction
â€¢ Polygon: $0.01-0.10 per transaction
â€¢ Solana: $0.00025 per transaction
```

### Performance Characteristics
```
Block Time: ~3.3 seconds
Finality: Instant (no confirmations needed)
TPS: ~6,000 transactions per second
Energy: Carbon negative (proof-of-stake)
```

---

## File Structure Breakdown

```
univault-mvp/
â”‚
â”œâ”€â”€ contracts/
â”‚   â””â”€â”€ VaultContract.js          # Smart contract wrapper
â”‚       â”œâ”€â”€ createVault()         # Deploy conditional vault
â”‚       â”œâ”€â”€ createMultiContributorVault()
â”‚       â”œâ”€â”€ createNFTTicket()     # Mint event tickets
â”‚       â”œâ”€â”€ transferTicket()      # Send ticket to attendee
â”‚       â””â”€â”€ verifyTicket()        # Check ownership
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ deploy-vault.js           # Deployment automation
â”‚       â”œâ”€â”€ Generate test accounts
â”‚       â”œâ”€â”€ Deploy conditional vault
â”‚       â”œâ”€â”€ Deploy multi-sig vault
â”‚       â”œâ”€â”€ Mint NFT ticket
â”‚       â””â”€â”€ Save deployment info
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html                # Frontend UI
â”‚       â”œâ”€â”€ Dashboard tab         # View deployed contracts
â”‚       â”œâ”€â”€ Create Vault tab      # New vault form
â”‚       â””â”€â”€ Tickets tab           # Verification interface
â”‚
â”œâ”€â”€ server.js                     # Express API server
â”‚   â”œâ”€â”€ /api/info                # Deployment details
â”‚   â”œâ”€â”€ /api/vault/*             # Vault operations
â”‚   â”œâ”€â”€ /api/ticket/*            # Ticket operations
â”‚   â””â”€â”€ /api/account/*           # Account queries
â”‚
â”œâ”€â”€ package.json                  # Dependencies
â”œâ”€â”€ .env                          # Configuration
â”œâ”€â”€ setup.sh                      # One-time setup
â”œâ”€â”€ start.sh                      # Quick start script
â”œâ”€â”€ README.md                     # Documentation
â”œâ”€â”€ COMMANDS.txt                  # Copy-paste commands
â”œâ”€â”€ QUICK-START.txt              # Quick reference
â””â”€â”€ DEMO-SCRIPT.md               # Presentation guide
```

---

## Deployment Process

```
Step 1: Install Dependencies
   npm install
   â””â”€â”€ Downloads @algorand/algosdk, express, etc.

Step 2: Deploy Contracts
   npm run deploy-contract
   â”œâ”€â”€ Generate 3 test accounts
   â”œâ”€â”€ Fund accounts at Algorand faucet
   â”œâ”€â”€ Deploy conditional vault (TEAL)
   â”œâ”€â”€ Deploy multi-sig vault
   â”œâ”€â”€ Mint NFT ticket (ASA)
   â””â”€â”€ Save deployment-info.json

Step 3: Start Server
   npm start
   â”œâ”€â”€ Launch Express on port 3000
   â”œâ”€â”€ Initialize Algorand client
   â”œâ”€â”€ Load deployment info
   â””â”€â”€ Serve frontend

Step 4: Use Application
   Open http://localhost:3000
   â””â”€â”€ Interact with deployed contracts
```

---

## Future Enhancements

### Phase 2 (Pilot)
```
âœ… QR code generation
âœ… Camera-based ticket scanning
âœ… Real event integration
âœ… Mobile app (React Native)
```

### Phase 3 (Scale)
```
âœ… On-chain reputation system
âœ… Cross-university interoperability
âœ… Batch payment processing
âœ… Governance token for platform decisions
```

### Advanced Features
```
âœ… Atomic swaps for vendor payments
âœ… Recurring payment schedules
âœ… Multi-currency support (stablecoins)
âœ… Integration with existing campus systems
```

---

## Monitoring & Debugging

### View Transactions
```
AlgoExplorer Testnet:
https://testnet.algoexplorer.io/

Search by:
â€¢ Address (vault or account)
â€¢ Transaction ID
â€¢ Asset ID (for NFT tickets)
```

### Check Logs
```bash
# Server logs
npm start

# Contract deployment logs
npm run deploy-contract
```

### Common Issues
```
Issue: "Insufficient funds"
Fix: Fund accounts at https://bank.testnet.algorand.network/

Issue: "Transaction rejected"
Fix: Check TEAL logic, ensure conditions met

Issue: "Asset not found"
Fix: Verify Asset ID, ensure it was created
```

---

## Conclusion

UniVault leverages Algorand's high-performance Layer 1 to deliver:
- **Transparency**: All transactions on public blockchain
- **Security**: Immutable smart contracts enforce rules
- **Efficiency**: Sub-penny transaction costs
- **Speed**: 3-second finality
- **Simplicity**: No crypto expertise needed

This architecture demonstrates a production-ready foundation for campus-wide financial infrastructure.
